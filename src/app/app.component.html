<div class="app-container">
  <!-- Normal view when scanner is not active -->
  <div class="content-container" [class.hidden]="scannerActive">
    <h2>{{ title }}</h2>
    
    <button 
      (click)="startScan()" 
      [disabled]="!hasPermission"
      class="scan-button">
      Start Scanner
    </button>

    <div class="result-container" *ngIf="scannedResult">
      <label for="barcode-result">Scanned Barcode:</label>
      <input 
        id="barcode-result" 
        type="text" 
        [value]="scannedResult" 
        readonly 
        class="result-input"
      />
    </div>

    <div class="error-container" *ngIf="errorMessage">
      <p class="error-message">{{ errorMessage }}</p>
    </div>
  </div>

  <!-- Fullscreen scanner overlay -->
  <div class="scanner-overlay" *ngIf="scannerActive">
    <div class="scanner-container">
      <zxing-scanner
        #scanner
        [formats]="allowedFormats"
        [enable]="previewEnabled"
        [device]="currentDevice"
        [torch]="torchEnabled"
        [tryHarder]="true"
        (scanSuccess)="onCodeResult($event)"
        (scanError)="handleError($event)">
      </zxing-scanner>

      <!-- Scanner UI Overlay -->
      <div class="scanner-ui">
        <!-- Close button -->
        <button class="close-button" (click)="stopScan()">
          âœ•
        </button>

        <!-- Torch toggle -->
        <button class="torch-button" (click)="toggleTorch()">
          {{ torchEnabled ? 'ðŸ’¡ Off' : 'ðŸ’¡ On' }}
        </button>

        <!-- Scanning area indicator -->
        <div class="scan-region" [class.success]="scanSuccess">
          <div class="scan-feedback">{{ scanFeedback }}</div>
        </div>

        <!-- Scan trigger button -->
        <button 
          class="scan-trigger-button" 
          (click)="triggerScan()" 
          [class.scanning]="scanningEnabled">
          {{ scanningEnabled ? 'Stop Scanning' : 'Tap to Scan' }}
        </button>
      </div>
    </div>
  </div>
</div>